(function(G){function v(){function a(c,b,f){var e=f.createElement("div");e.innerHTML=b;m(e,"visibility","hidden");f.body.appendChild(e);h(e);y(e);A(e);if(!c)for(p.removeWhiteSpace(e),c=e.firstChild;c;){b=c.nextSibling;if(p.isInline(c)&&!H(c,".sceditor-ignore")){if(!k){var k=e.ownerDocument.createElement("p");c.parentNode.insertBefore(k,c)}k.appendChild(c)}else k=null;c=b}k=(new G.XHTMLSerializer).serialize(e,!0);f.body.removeChild(e);return k}function g(c,b){l[c]&&l[c].forEach(function(f){f.tags[c]?
I(f.tags[c],function(e,k){b.getAttributeNode&&(e=b.getAttributeNode(e),!e||k&&0>k.indexOf(e.value)||f.conv.call(d,b))}):f.conv&&f.conv.call(d,b)})}function h(c){p.traverse(c,function(b){var f=b.nodeName.toLowerCase();g("*",b);g(f,b)},!0)}function u(c,b){var f=c.childNodes,e=c.nodeName.toLowerCase(),k=c.nodeValue,q=f.length,x=v.allowedEmptyTags||[];if(b&&"br"===e||H(c,".sceditor-ignore"))return!0;if(-1<x.indexOf(e)||"td"===e||!p.canHaveChildren(c)||k&&/\S|\u00A0/.test(k))return!1;for(;q--;)if(!u(f[q],
b&&!c.previousSibling&&!c.nextSibling))return!1;return c.getBoundingClientRect&&(c.className||c.hasAttributes("style"))?(c=c.getBoundingClientRect(),!c.width||!c.height):!0}function y(c){p.traverse(c,function(b){var f,e=b.nodeName.toLowerCase(),k=b.parentNode,q=b.nodeType,x=!p.isInline(b),D=b.previousSibling,E=b.nextSibling,z=k===c;z="iframe"!==e&&u(b,z&&!D&&!E&&"br"!==e);var J=b.ownerDocument,B=v.allowedTags,N=b.firstChild,K=v.disallowedTags;if(3!==q){if(4===q)e="!cdata";else if("!"===e||8===q)e=
"!comment";1===q&&H(b,".sceditor-nlf")&&(!N||1===b.childNodes.length&&/br/i.test(N.nodeName)?z=!0:(b.classList.remove("sceditor-nlf"),b.className||r(b,"class")));z?f=!0:B&&B.length?f=0>B.indexOf(e):K&&K.length&&(f=-1<K.indexOf(e));if(f){if(!z){for(x&&D&&p.isInline(D)&&k.insertBefore(J.createTextNode(" "),b);b.firstChild;)k.insertBefore(b.firstChild,E);x&&E&&p.isInline(E)&&k.insertBefore(J.createTextNode(" "),E)}k.removeChild(b)}}},!0)}function w(c,b){var f={};c&&(f=O({},f,c));if(!b)return f;I(b,function(e,
k){Array.isArray(k)?f[e]=(f[e]||[]).concat(k):f[e]||(f[e]=null)});return f}function A(c){var b,f,e,k,q,x,D=v.allowedAttribs,E=D&&!L(D),z=v.disallowedAttribs,J=z&&!L(z);n={};p.traverse(c,function(B){if(B.attributes&&(b=B.nodeName.toLowerCase(),k=B.attributes.length))for(n[b]||(n[b]=E?w(D["*"],D[b]):w(z["*"],z[b]));k--;)f=B.attributes[k],e=f.name,q=n[b][e],x=!1,E?x=null!==q&&(!Array.isArray(q)||0>q.indexOf(f.value)):J&&(x=null===q||Array.isArray(q)&&-1<q.indexOf(f.value)),x&&B.removeAttribute(e)})}
var d=this,l={},n={};d.init=function(){L(v.converters||{})||I(v.converters,function(c,b){I(b.tags,function(f){l[f]||(l[f]=[]);l[f].push(b)})});this.commands=O(!0,{},P,this.commands)};d.toSource=a.bind(null,!1);d.fragmentToSource=a.bind(null,!0)}var p=G.dom,M=G.utils,m=p.css,t=p.attr,H=p.is,r=p.removeAttr,C=p.convertElement,O=M.extend,I=M.each,L=M.isEmptyObject,F=G.command.get,P={bold:{txtExec:["<strong>","</strong>"]},italic:{txtExec:["<em>","</em>"]},underline:{txtExec:['<span style="text-decoration:underline;">',
"</span>"]},strike:{txtExec:['<span style="text-decoration:line-through;">',"</span>"]},subscript:{txtExec:["<sub>","</sub>"]},superscript:{txtExec:["<sup>","</sup>"]},left:{txtExec:['<div style="text-align:left;">',"</div>"]},center:{txtExec:['<div style="text-align:center;">',"</div>"]},right:{txtExec:['<div style="text-align:right;">',"</div>"]},justify:{txtExec:['<div style="text-align:justify;">',"</div>"]},font:{txtExec:function(a){var g=this;F("font")._dropDown(g,a,function(h){g.insertText('<span style="font-family:'+
h+';">',"</span>")})}},size:{txtExec:function(a){var g=this;F("size")._dropDown(g,a,function(h){g.insertText('<span style="font-size:'+h+';">',"</span>")})}},color:{txtExec:function(a){var g=this;F("color")._dropDown(g,a,function(h){g.insertText('<span style="color:'+h+';">',"</span>")})}},bulletlist:{txtExec:["<ul><li>","</li></ul>"]},orderedlist:{txtExec:["<ol><li>","</li></ol>"]},table:{txtExec:["<table><tr><td>","</td></tr></table>"]},horizontalrule:{txtExec:["<hr />"]},code:{txtExec:["<code>",
"</code>"]},image:{txtExec:function(a,g){var h=this;F("image")._dropDown(h,a,g,function(u,y,w){var A="";y&&(A+=' width="'+y+'"');w&&(A+=' height="'+w+'"');h.insertText("<img"+A+' src="'+u+'" />')})}},email:{txtExec:function(a,g){var h=this;F("email")._dropDown(h,a,function(u,y){h.insertText('<a href="mailto:'+u+'">'+(y||g||u)+"</a>")})}},link:{txtExec:function(a,g){var h=this;F("link")._dropDown(h,a,function(u,y){h.insertText('<a href="'+u+'">'+(y||g||u)+"</a>")})}},quote:{txtExec:["<blockquote>",
"</blockquote>"]},youtube:{txtExec:function(a){var g=this;F("youtube")._dropDown(g,a,function(h,u){g.insertText('<iframe width="560" height="315" src="https://www.youtube.com/embed/{id}?wmode=opaque&start='+u+'" data-youtube-id="'+h+'" frameborder="0" allowfullscreen></iframe>')})}},rtl:{txtExec:['<div stlye="direction:rtl;">',"</div>"]},ltr:{txtExec:['<div stlye="direction:ltr;">',"</div>"]}};G.XHTMLSerializer=function(){function a(d){var l={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","\u00a0":"&nbsp;"};
return d?d.replace(/[&<>"\xa0]/g,function(n){return l[n]||n}):""}function g(d,l){switch(d.nodeType){case 1:var n,c=d.nodeName.toLowerCase(),b="iframe"===c,f=d.attributes.length,e=d.firstChild,k=l||/pre(?:\-wrap)?$/i.test(m(d,"whiteSpace")),q=!d.firstChild&&!p.canHaveChildren(d)&&!b;if(!H(d,".sceditor-ignore")){for(h("<"+c,!l&&u(d));f--;){l=d.attributes[f];var x=l.value;h(" "+l.name.toLowerCase()+'="'+a(x)+'"',!1)}h(q?" />":">",!1);for(b||(n=e);n;)A++,g(n,k),n=n.nextSibling,A--;q||h("</"+c+">",!k&&
!b&&u(d)&&e&&u(e))}break;case 3:n=d.nodeValue;l||(n=n.replace(/[^\S\u00A0]+/g," "));n&&h(a(n),!l&&u(d));break;case 4:h("<![CDATA["+a(d.nodeValue)+"]]\x3e");break;case 8:h("\x3c!-- "+a(d.nodeValue)+" --\x3e");break;case 9:case 11:for(d=d.firstChild;d;)g(d),d=d.nextSibling}}function h(d,l){var n=A;if(!1!==l)for(w.length&&w.push("\n");n--;)w.push(y.indentStr);w.push(d)}function u(d){var l=d.previousSibling;return 1!==d.nodeType&&l?!p.isInline(l):l||p.isInline(d.parentNode)?!p.isInline(d):!0}var y={indentStr:"\t"},
w=[],A=0;this.serialize=function(d,l){w=[];if(l)for(d=d.firstChild;d;)g(d),d=d.nextSibling;else g(d);return w.join("")}};v.converters=[{tags:{"*":{width:null}},conv:function(a){m(a,"width",t(a,"width"));r(a,"width")}},{tags:{"*":{height:null}},conv:function(a){m(a,"height",t(a,"height"));r(a,"height")}},{tags:{li:{value:null}},conv:function(a){r(a,"value")}},{tags:{"*":{text:null}},conv:function(a){m(a,"color",t(a,"text"));r(a,"text")}},{tags:{"*":{color:null}},conv:function(a){m(a,"color",t(a,"color"));
r(a,"color")}},{tags:{"*":{face:null}},conv:function(a){m(a,"fontFamily",t(a,"face"));r(a,"face")}},{tags:{"*":{align:null}},conv:function(a){m(a,"textAlign",t(a,"align"));r(a,"align")}},{tags:{"*":{border:null}},conv:function(a){m(a,"borderWidth",t(a,"border"));r(a,"border")}},{tags:{applet:{name:null},img:{name:null},layer:{name:null},map:{name:null},object:{name:null},param:{name:null}},conv:function(a){t(a,"id")||t(a,"id",t(a,"name"));r(a,"name")}},{tags:{"*":{vspace:null}},conv:function(a){m(a,
"marginTop",t(a,"vspace")-0);m(a,"marginBottom",t(a,"vspace")-0);r(a,"vspace")}},{tags:{"*":{hspace:null}},conv:function(a){m(a,"marginLeft",t(a,"hspace")-0);m(a,"marginRight",t(a,"hspace")-0);r(a,"hspace")}},{tags:{hr:{noshade:null}},conv:function(a){m(a,"borderStyle","solid");r(a,"noshade")}},{tags:{"*":{nowrap:null}},conv:function(a){m(a,"whiteSpace","nowrap");r(a,"nowrap")}},{tags:{big:null},conv:function(a){m(C(a,"span"),"fontSize","larger")}},{tags:{small:null},conv:function(a){m(C(a,"span"),
"fontSize","smaller")}},{tags:{b:null},conv:function(a){C(a,"strong")}},{tags:{u:null},conv:function(a){m(C(a,"span"),"textDecoration","underline")}},{tags:{s:null,strike:null},conv:function(a){m(C(a,"span"),"textDecoration","line-through")}},{tags:{dir:null},conv:function(a){C(a,"ul")}},{tags:{center:null},conv:function(a){m(C(a,"div"),"textAlign","center")}},{tags:{font:{size:null}},conv:function(a){m(a,"fontSize",m(a,"fontSize"));r(a,"size")}},{tags:{font:null},conv:function(a){C(a,"span")}},{tags:{"*":{type:["_moz"]}},
conv:function(a){r(a,"type")}},{tags:{"*":{_moz_dirty:null}},conv:function(a){r(a,"_moz_dirty")}},{tags:{"*":{_moz_editor_bogus_node:null}},conv:function(a){a.parentNode.removeChild(a)}},{tags:{"*":{"data-sce-target":null}},conv:function(a){var g=t(a,"rel")||"",h=t(a,"data-sce-target");"_blank"===h&&H(a,"a")&&(/(^|\s)noopener(\s|$)/.test(g)||t(a,"rel","noopener"+(g?" "+g:"")),t(a,"target",h));r(a,"data-sce-target")}},{tags:{code:null},conv:function(a){for(var g=a.getElementsByTagName("div");a=g[0];)a.style.display=
"block",C(a,"span")}}];v.allowedAttribs={};v.disallowedAttribs={};v.allowedTags=[];v.disallowedTags=[];v.allowedEmptyTags=[];G.formats.xhtml=v})(sceditor);
